---
doc_type: explanation
status: active
updated: 2026-01-24
audience: [developer, ai-agent]
tags:
  - architecture
  - overview
---

# БЗ2: Транскрибатор видео — Обзор

Система для автоматической транскрипции и саммаризации видеозаписей обучающих мероприятий. Часть проекта **БЗ2** — базы знаний для команды консультантов по питанию Herbalife.

## Названия

| Назначение | Название |
|------------|----------|
| UI (интерфейс) | **БЗ2: Транскрибатор видео** |
| Техническое | **bz2-video-transcriber** |

## Цели системы

| Цель | Описание |
|------|----------|
| **Транскрипция** | Преобразование видео в текст с помощью Whisper |
| **Очистка** | Удаление слов-паразитов и нормализация терминологии |
| **Саммаризация** | Создание краткого содержания с классификацией для БЗ 2.0 |
| **Chunking** | Разбиение на смысловые блоки для RAG-поиска |
| **Организация** | Структурированное хранение по дате и типу мероприятия |

## Источник данных

Записи Понедельничной Школы (ПШ) — внутреннее обучение с двумя потоками:

| Поток                | Код | Аудитория               |
| -------------------- | --- | ----------------------- |
| Супервайзеры         | SV  | Консультанты по питанию |
| Независимые партнёры | НП  | Начинающие консультанты |

В дальнейшем предполагаются записи с других типов мероприятий.

---

## Как это работает

```
Видео + [Слайды] → Parse → Whisper → Clean → [Slides] → Longread/Story → Summary → Chunk (H2) → Save
```

### Pipeline обработки (7+ этапов)

| # | Этап | Описание | Провайдер |
|---|------|----------|-----------|
| 1 | Parse | Извлечение метаданных из имени файла | — |
| 2 | Transcribe | GPU транскрипция | Whisper |
| 3 | Clean | Удаление паразитов, нормализация терминов | Claude |
| 3.5 | Slides | Извлечение текста со слайдов (опционально, v0.51+) | Claude Vision |
| 4 | Longread/Story | Генерация развёрнутого текста | Claude |
| 5 | Summary | Конспект + классификация для БЗ 2.0 | Claude |
| 6 | Chunk | Разбиение по H2 заголовкам (детерминистический) | — |
| 7 | Save | Сохранение в структурированный архив | — |

**Ветвление по типу контента (v0.23+):**
- `EDUCATIONAL` → Longread → Summary → longread.md + summary.md
- `LEADERSHIP` → Story → story.md (8 блоков)

**Слайды (v0.51+):**
- Опциональный шаг, выполняется только если пользователь прикрепил слайды
- Извлечённый текст обогащает генерацию Longread/Story
- Поддержка изображений (JPEG, PNG, WebP) и PDF

> **Детальное описание этапов:** [pipeline/](pipeline/)

---

## AI сервисы

> **Ключевое решение (v0.29+):** Основной LLM провайдер — Claude API (Anthropic). Это обеспечивает высокое качество обработки русского текста и большой контекст (200K токенов).

### Используемые сервисы

| Сервис | Адрес | Назначение |
|--------|-------|------------|
| **Claude API** | api.anthropic.com (через прокси) | Очистка, longread, summary, story |
| **faster-whisper** | http://100.64.0.1:9000 | Транскрипция видео |
| **Ollama** | http://100.64.0.1:11434 | Резервный LLM (опционально) |

### Модели (v0.29+, updated v0.51)

| Задача | Модель | Обоснование |
|--------|--------|-------------|
| Транскрипция | large-v3-turbo | Баланс качества и скорости |
| Очистка текста | claude-sonnet-4-5 | Высокое качество, контекст 200K |
| Слайды | claude-haiku-4-5 | Быстро и дёшево для извлечения текста (v0.51+) |
| Longread | claude-sonnet-4-5 | Качественная генерация длинного текста |
| Summary | claude-sonnet-4-5 | Структурированный вывод |
| Story | claude-sonnet-4-5 | Генерация 8 блоков истории |
| Chunking | — | Детерминистический (H2 парсинг) |

### Почему Claude?

- Контекст 200K токенов — вся транскрипция обрабатывается целиком
- Высокое качество генерации на русском языке
- Надёжность облачного API
- Прозрачная стоимость ($3/$15 за 1M токенов для Sonnet)

### Метрики и стоимость (v0.42+)

Система отслеживает расширенные метрики для каждого этапа:
- `tokens_used` — входные и выходные токены
- `cost` — стоимость в USD
- `processing_time_sec` — время выполнения

Метрики отображаются в UI для контроля затрат.

---

## Быстрый старт

### Проверка AI сервисов

```bash
# Ollama
curl http://100.64.0.1:11434/api/version

# Whisper
curl http://100.64.0.1:9000/health
```

### Запуск системы

```bash
docker-compose up -d
```

### Доступ

| Сервис | URL |
|--------|-----|
| Web UI | http://localhost:8802 |
| Backend API | http://localhost:8801 |

> **Подробнее:** [deployment.md](deployment.md)

---

## Документация

| Документ | Описание |
|----------|----------|
| [architecture.md](architecture.md) | Техническая архитектура, схемы |
| [pipeline/](pipeline/) | Детальный pipeline (7 этапов) |
| [configuration.md](configuration.md) | Конфигурация моделей и промптов |
| [data-formats.md](data-formats.md) | Форматы файлов, метрики (v0.42+) |
| [api-reference.md](api-reference.md) | HTTP API |
| [deployment.md](deployment.md) | Развёртывание на TrueNAS |
| [adr/](adr/) | Architecture Decision Records |
