# БЗ2: Транскрибатор видео — Обзор

Система для автоматической транскрипции и саммаризации видеозаписей обучающих мероприятий. Часть проекта **БЗ2** — базы знаний для команды консультантов по питанию Herbalife.

## Названия

| Назначение | Название |
|------------|----------|
| UI (интерфейс) | **БЗ2: Транскрибатор видео** |
| Техническое | **bz2-video-transcriber** |

## Цели системы

| Цель | Описание |
|------|----------|
| **Транскрипция** | Преобразование видео в текст с помощью Whisper |
| **Очистка** | Удаление слов-паразитов и нормализация терминологии |
| **Саммаризация** | Создание краткого содержания с классификацией для БЗ 2.0 |
| **Chunking** | Разбиение на смысловые блоки для RAG-поиска |
| **Организация** | Структурированное хранение по дате и типу мероприятия |

## Источник данных

Записи Понедельничной Школы (ПШ) — внутреннее обучение с двумя потоками:

| Поток                | Код | Аудитория               |
| -------------------- | --- | ----------------------- |
| Супервайзеры         | SV  | Консультанты по питанию |
| Независимые партнёры | НП  | Начинающие консультанты |

В дальнейшем предполагаются записи с других типов мероприятий.

---

## Как это работает

```
Видео → Парсинг → Whisper → Очистка → Chunking → Саммари → Архив
```

### Pipeline обработки (6 этапов)

| # | Этап | Описание |
|---|------|----------|
| 1 | Parse | Извлечение метаданных из имени файла |
| 2 | Transcribe | GPU транскрипция через Whisper |
| 3 | Clean | Удаление паразитов, нормализация терминов |
| 4 | Chunk | Разбиение на смысловые блоки (100-400 слов) |
| 5 | Summarize | Саммари + классификация для БЗ 2.0 |
| 6 | Save | Сохранение в структурированный архив |

> **Детальное описание этапов:** [pipeline/](pipeline/)

---

## AI сервисы

> **Ключевое решение:** БЗ2 использует общую инфраструктуру AI сервисов вместо встроенных компонентов. Это упрощает приложение и исключает дублирование ресурсов.

### Используемые сервисы

| Сервис | Адрес | Назначение |
|--------|-------|------------|
| **Ollama** | http://100.64.0.1:11434 | Очистка, chunking, саммаризация |
| **faster-whisper** | http://100.64.0.1:9000 | Транскрипция видео |

### Модели

| Задача | Модель | Обоснование |
|--------|--------|-------------|
| Транскрипция | large-v3 | Лучшее качество для русского |
| Очистка текста | qwen2.5:14b | Отличный русский, понимание контекста |
| Chunking | qwen2.5:14b | Смысловое разбиение требует понимания |
| Саммаризация | qwen2.5:14b | Качественные саммари на русском |

### Почему qwen2.5:14b?

- Qwen2.5 обучен на значительно большем корпусе русского текста
- Для работы с терминологией Herbalife важно точное понимание русского контекста
- 14B параметров дают лучшее качество при работе с длинными текстами

### Преимущества интеграции с общими сервисами

| Аспект | Встроенные компоненты | Общие сервисы |
|--------|----------------------|----------------|
| Размер образа | ~15 GB (с моделями) | ~500 MB |
| Дублирование моделей | Да | Нет |
| Обновление моделей | Пересборка образа | Независимо |
| Использование GPU | Требует настройки | Уже настроено |
| Код приложения | Сложный | Простой (HTTP вызовы) |

---

## Быстрый старт

### Проверка AI сервисов

```bash
# Ollama
curl http://100.64.0.1:11434/api/version

# Whisper
curl http://100.64.0.1:9000/health
```

### Запуск системы

```bash
docker-compose up -d
```

### Доступ

| Сервис | URL |
|--------|-----|
| Web UI | http://localhost:8802 |
| Backend API | http://localhost:8801 |

> **Подробнее:** [deployment.md](deployment.md)

---

## Документация

| Документ | Описание |
|----------|----------|
| [architecture.md](architecture.md) | Техническая архитектура, схемы |
| [pipeline/](pipeline/) | Детальный pipeline (6 этапов) |
| [web-ui.md](web-ui.md) | Документация Web UI |
| [deployment.md](deployment.md) | Развёртывание на TrueNAS |
| [data-formats.md](data-formats.md) | Форматы файлов |
| [api-reference.md](api-reference.md) | HTTP API для Ollama и Whisper |
| [CONTRIBUTING.md](CONTRIBUTING.md) | Процесс разработки |
