# Процесс разработки с Claude Code

> Памятка: жизненный цикл требований, шаблоны запросов, роли документов

---

## 1. Жизненный цикл требования

Каждое требование из `docs/requirements/` проходит цикл:

```
Draft → Ready → In Progress → Done
```

| Переход | Что происходит | Кто |
|---------|---------------|-----|
| Draft → Ready | Ревью requirement-документа, все вопросы закрыты | Разработчик + Claude |
| Ready → In Progress | `/preflight` → разбивка на этапы → план первого этапа | Claude (`/preflight`) |
| In Progress → Done | Все этапы реализованы, `/finalize` пройден | Claude (`/finalize`) |

---

## 2. Ключевые команды

### `/preflight` — архитектурный контекст перед реализацией

**Что делает:** Читает ARCHITECTURE.md, ADR, `.claude/rules/`, CLAUDE.md — и проектирует фичу так, чтобы она вписалась в существующую архитектуру.

**Когда вызывать:**
- В начале работы над новым требованием
- В начале нового этапа (если затрагивает новые модули)

**Как вызывать:**
```
/preflight docs/requirements/{файл}.md
/preflight docs/plans/{план-этапа}.md
/preflight {описание задачи}
```

### `/finalize` — проверка после реализации

**Что делает:** Анализирует фактические изменения в коде. Проверяет соответствие rules, актуальность ARCHITECTURE.md, необходимость ADR.

**Когда вызывать:**
- После завершения каждого этапа
- После завершения всего требования
- После значимых изменений

---

## 3. Шаблоны запросов

### Начало нового требования

```
Начинаем реализацию {название} из requirements/.
/preflight docs/requirements/{файл}.md
```

Claude: `/preflight` (архитектурный контекст) → разбивка на этапы → план первого этапа в `docs/plans/` → реализация.

### Продолжение работы (следующая сессия)

```
Продолжаем {название}.
Текущий статус в docs/requirements/{файл}.md (секция "Прогресс").
Задача: {конкретный этап или описание}.
```

### Завершение требования

```
{Название} реализован. /finalize
```

Claude: `/finalize` → обновляет статус → проверяет документацию.

### Быстрая доработка / баг

```
# Простой (1-2 файла)
{Описание бага/доработки}

# Сложный
{Описание} — нужен план.
```

---

## 4. Роли документов

| Документ | Отвечает за | Когда обновлять |
|----------|------------|-----------------|
| `docs/requirements/{файл}.md` | **Зачем** и **как**: спецификация + прогресс | При реализации: секция "Прогресс" |
| `docs/plans/{этап}.md` | **Детальный план** конкретного этапа | Создаётся перед этапом, архивируется после |
| `docs/ARCHITECTURE.md` | **Карта системы**: модули, таблицы, связи | После реализации (через `/finalize`) |
| `docs/architecture/*.md` | **Детали подсистем**: схемы, API, потоки | После реализации подсистемы |
| `docs/decisions/ADR-*.md` | **Почему** так решили | При значимых решениях |
| `.claude/rules/` | **Паттерны модулей**: как пишется код | `/finalize` проверяет соответствие |
| `CLAUDE.md` | **Инструкции** для Claude Code | При изменении процесса или структуры |

---

## 5. Чеклист перехода между требованиями

Когда текущее требование получает статус Done:

- [ ] Секция "Прогресс" в requirement-документе заполнена (этапы, решения)
- [ ] `/finalize` пройден (ARCHITECTURE.md, правила, ADR актуальны)
- [ ] CLAUDE.md: структура проекта актуальна (если менялась)
- [ ] Планы в `docs/plans/` можно архивировать

Перед началом следующего:

- [ ] Прочитать requirement-документ следующего требования
- [ ] Убедиться что все вопросы закрыты (статус Draft → Ready)

---

## 6. Структура этапов внутри требования

Крупные требования разбиваются на этапы:

```
Требование: {feature-name}
├── Этап 1: {описание}
├── Этап 2: {описание}
└── Этап 3: {описание}
```

Каждый этап:
1. `/preflight` (если затрагивает новые модули) → план в `docs/plans/`
2. Реализация
3. Тестирование
4. Отметка в секции "Прогресс" requirement-документа
5. `/finalize` (после последнего этапа или при значимых изменениях)

---

## Связанные документы

| Документ | Назначение |
|----------|------------|
| [CLAUDE.md](../CLAUDE.md) | Инструкции для Claude Code (секция Workflow) |
| [ARCHITECTURE.md](ARCHITECTURE.md) | Техническая архитектура системы |
| [COMMANDS-REFERENCE.md](COMMANDS-REFERENCE.md) | Справочник slash-команд |

---

_Памятка по процессу. Обновлять при изменении workflow._
