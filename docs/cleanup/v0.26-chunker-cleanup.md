# План очистки: удаление LLM-чанкера (v0.26)

## Цель

Удалить устаревший код LLM-чанкера после перехода на детерминистический H2-чанкинг (v0.25).
Получить чистую архитектуру без мёртвого кода.

## Контекст

В v0.25 реализован детерминистический чанкинг по H2 заголовкам:
- Файл: `backend/app/utils/h2_chunker.py`
- Функция: `chunk_by_h2(markdown_content)` — regex парсинг
- Не требует LLM, работает мгновенно

Старый LLM-чанкер (`chunker.py`) больше не используется.

## Файлы для удаления

### 1. Полное удаление

| Файл | Причина |
|------|---------|
| `backend/app/services/chunker.py` | Весь файл — старый LLM-чанкер |

### 2. Удаление настроек

| Файл | Что удалить |
|------|-------------|
| `backend/app/config.py` | `chunker_model: str` из Settings |
| `docker-compose.yml` | `CHUNKER_MODEL` переменная |

### 3. Очистка конфигов

| Файл | Что удалить |
|------|-------------|
| `config/models.yaml` | Секции `chunker` из всех моделей |

### 4. Обновление кода

| Файл | Действие |
|------|----------|
| `backend/app/services/pipeline/config_resolver.py` | Удалить `chunker` из resolver |
| `backend/app/api/cache_routes.py` | Удалить `chunker` из cache stages |
| `backend/app/services/saver.py` | Проверить использование chunker |
| `backend/app/models/cache.py` | Удалить `CHUNKING` из CacheStageName если есть |

### 5. Документация

| Файл | Действие |
|------|----------|
| `CLAUDE.md` | Удалить упоминания chunker_model |
| `docs/configuration.md` | Удалить CHUNKER_MODEL из списка настроек |
| `docs/model-testing.md` | Удалить тесты чанкера |

## Проверка

После очистки:

```bash
# Поиск оставшихся упоминаний
grep -r "chunker_model" backend/
grep -r "chunker" config/models.yaml
grep -r "CHUNKER_MODEL" .

# Тесты
python -m pytest backend/tests/
```

## Ожидаемый результат

- Удалён ~400 строк мёртвого кода
- Одна переменная окружения меньше
- Чистая конфигурация моделей
- Простая архитектура чанкинга
