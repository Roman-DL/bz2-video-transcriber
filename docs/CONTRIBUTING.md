# Процесс разработки

Гайд по добавлению новых функций и поддержанию документации в актуальном состоянии.

## Планирование новых функций

### Для небольших изменений

- Описать в issue или в начале PR
- После реализации: обновить [overview.md](overview.md) если меняется scope системы

### Для крупных функций

1. Создать RFC-документ в `docs/proposals/{название}.md`
2. Описать: цель, подход, затрагиваемые компоненты
3. После реализации: перенести описание в [overview.md](overview.md), удалить RFC

---

## Чеклисты по типам изменений

### Новый этап pipeline

При добавлении нового этапа обработки:

- [ ] Создать сервис в `backend/app/services/{название}.py`
- [ ] Добавить модель в `backend/app/models/schemas.py`
- [ ] Создать документацию `docs/pipeline/XX-{название}.md`
- [ ] Обновить `docs/pipeline/README.md` (схема, таблица этапов)
- [ ] Обновить `docs/data-formats.md` если новый формат данных
- [ ] Добавить API endpoint если нужен пошаговый режим

### Новый API endpoint

- [ ] Добавить route в `backend/app/routers/`
- [ ] Обновить `docs/architecture.md` (таблица API Endpoints)
- [ ] Обновить `docs/pipeline/08-api.md` если endpoint связан с pipeline

### Изменение конфигурации

- [ ] Обновить `docs/deployment.md`
- [ ] Обновить `.env.example`
- [ ] Обновить `CLAUDE.md` если критично для AI-ассистента

### Изменение Web UI

- [ ] Обновить `docs/web-ui.md` (компоненты, режимы)
- [ ] Обновить скриншоты/mockups если существенные визуальные изменения

### Новый промпт или изменение существующего

- [ ] Обновить/создать файл в `config/prompts/`
- [ ] Протестировать в пошаговом режиме Web UI
- [ ] Обновить `docs/pipeline/{этап}.md` если меняется логика

### Изменение глоссария

- [ ] Обновить `config/glossary.yaml`
- [ ] Обновить `docs/reference/terminology.md` если добавляются новые категории

---

## Принципы документирования

> Полные гайдлайны: [DOCUMENTATION_GUIDELINES.md](DOCUMENTATION_GUIDELINES.md)

### Что документировать

| Категория | Где | Пример |
|-----------|-----|--------|
| Архитектура | docs/*.md | Схемы, потоки данных |
| Решения | docs/*.md | Почему выбран подход A, а не B |
| API контракты | docs/api-reference.md | HTTP API внешних сервисов |
| Pipeline этапы | docs/pipeline/*.md | Логика, модели данных |
| Конфигурация | docs/deployment.md | Переменные окружения |

### Что НЕ документировать

- Сигнатуры методов (читаются из кода)
- Константы и переменные (читаются из кода)
- Примеры кода с конкретными значениями (устаревают)

### Принцип: код — источник истины

- Docstrings в коде всегда актуальны
- Документация описывает "что" и "почему", не "как"
- Обновлять документы сразу после реализации

---

## Когда обновлять документацию

| Изменение | Обновить docs? | Что обновить |
|-----------|----------------|--------------|
| Новый сервис/этап | Да | docs/pipeline/ |
| Рефакторинг метода | Нет | Только docstring в коде |
| Изменение публичного API | Да | architecture.md, pipeline/08-api.md |
| Новая конфигурация | Да | deployment.md, CLAUDE.md |
| Архитектурное решение | Да | Зафиксировать "почему" |
| Новый формат данных | Да | data-formats.md |

---

## Структура документации

```
docs/
├── README.md              # Навигация
├── overview.md            # Обзор системы (для всех)
├── architecture.md        # Техническая архитектура
├── web-ui.md              # Web интерфейс
├── CONTRIBUTING.md        # Этот документ
├── DOCUMENTATION_GUIDELINES.md  # Стиль документирования
├── api-reference.md       # API внешних сервисов
├── data-formats.md        # Форматы данных
├── deployment.md          # Развёртывание
├── pipeline/              # Этапы обработки
│   ├── README.md
│   └── 01-parse.md ... 08-api.md
├── reference/
│   └── terminology.md     # Глоссарий
└── archive/               # Исторические документы
```
