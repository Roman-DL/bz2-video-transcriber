# Performance coefficients for progress estimation
#
# Used by ProgressEstimator to calculate estimated processing time
# and show progress percentage during video processing.
#
# How to update:
# 1. Run processing on test files of different sizes
# 2. Check PERF logs: docker logs bz2-transcriber | grep "PERF |"
# 3. Calculate new coefficients and update this file
#
# Coefficients based on test data:
# v1 (2026-01-09): 5 min file, transcribe=87.1s, clean=8.0s, chunk=10.3s, summarize=17.1s
# v2 (2026-01-10): 5 min file, clean=6.0s/4535chars, chunk=7.4s/1335chars, summarize=7.1s/1335chars

version: 3
updated: "2026-01-11"
notes: "Recalibrated based on 55-min video test (3308s)"

# Transcription: depends on video duration
# Formula: estimated_time = base_time + (video_duration_seconds * factor)
transcribe:
  # Seconds of processing per second of video
  # v2: 0.29 (4.8x overestimated for 55-min video)
  # v3: (199-5)/3308 = 0.0587, +30% margin = 0.08
  factor_per_video_second: 0.08
  base_time: 5.0  # GPU warmup, file loading overhead

# Text cleaning (LLM): depends on input text length
# Formula: estimated_time = base_time + (input_chars / 1000 * factor)
clean:
  # Seconds per 1000 input characters
  # v2: 0.9 (1.3x underestimated, stuck at 95% for 14.5s)
  # v3: (57.5-2)/47.2k = 1.18, +20% margin = 1.4
  factor_per_1k_chars: 1.4
  base_time: 2.0

# Semantic chunking (LLM): depends on input text length
# Formula: estimated_time = base_time + (input_chars / 1000 * factor)
chunk:
  # Seconds per 1000 input characters
  # v2: 4.0 (1.4x overestimated)
  # v3: (60.1-2)/20.9k = 2.78, +15% margin = 3.2
  factor_per_1k_chars: 3.2
  base_time: 2.0

# Summarization (LLM): depends on input text length
# Formula: estimated_time = base_time + (input_chars / 1000 * factor)
summarize:
  # Seconds per 1000 input characters
  # v2: 3.0 (2.9x overestimated)
  # v3: (22.5-3)/20.9k = 0.93, +30% margin = 1.2
  # Includes: outline extraction + LLM generation
  factor_per_1k_chars: 1.2
  base_time: 3.0

# Fixed-time stages (not estimated dynamically)
fixed_stages:
  parse: 1.0   # Metadata extraction, very fast
  save: 2.0    # File operations, depends on disk speed
